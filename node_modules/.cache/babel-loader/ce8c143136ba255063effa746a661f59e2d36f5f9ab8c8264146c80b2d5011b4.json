{"ast":null,"code":"import React,{useContext,useEffect,useState}from\"react\";import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import Home from\"./pages/Home\";import Login from\"./pages/Login\";import Register from\"./pages/Register\";import Dashboard from\"./pages/Dashboard\";import Profile from\"./pages/Profile\";import{SetAllAccessTokens,StoreContext}from\"./mobx stores/RootStore\";import{auth,onAuthStateChangedListener// requestPermission,\n}from\"./firebase/firebase\";import PrivateRoute from\"./component/PrivateRoute\";// import ProtectedRoute from \"./component/ProtectedRoute\";\nimport{observer}from\"mobx-react-lite\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const{profileStore,authStore,walletStore}=useContext(StoreContext);const[user,setUser]=useState(null);const[activeUser,setActiveUser]=React.useState(false||window.sessionStorage.getItem(\"userStatus\")===\"true\");useEffect(()=>{const unsubscribe=onAuthStateChangedListener(async res=>{if(res){res===null||res===void 0?void 0:res.getIdToken(true).then(idToken=>{window.sessionStorage.setItem(\"accessToken\",idToken);SetAllAccessTokens(idToken);try{authStore.setUser(res);profileStore.getProfile();// walletStore.getWallet(); // to call when on dashboard and disable from here\n}catch(error){}finally{}});if(res){if(res.emailVerified){window.sessionStorage.setItem(\"userStatus\",\"true\");setActiveUser(true);}}else{window.sessionStorage.setItem(\"userStatus\",\"false\");setActiveUser(false);}return res?setUser(res):setUser(null);}});return unsubscribe;},[]);useEffect(()=>{const checkAndRenewToken=async()=>{const userData=auth.currentUser;if(userData){try{await userData.getIdToken(true).then(idToken=>{window.sessionStorage.setItem(\"accessToken\",idToken);SetAllAccessTokens(idToken);});// console.debug('Token refreshed successfully.');\n}catch(err){// console.debug('Error refreshing token:', err);\n}}};const intervalCheck=setInterval(checkAndRenewToken,600000);return()=>clearInterval(intervalCheck);},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"\",children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/*\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),/*#__PURE__*/_jsxs(Route,{element:/*#__PURE__*/_jsx(PrivateRoute,{activeUser:auth.currentUser}),children:[/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(Dashboard,{})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(Profile,{})})]})]})})});}export default observer(App);","map":{"version":3,"names":["React","useContext","useEffect","useState","BrowserRouter","Router","Routes","Route","Home","Login","Register","Dashboard","Profile","SetAllAccessTokens","StoreContext","auth","onAuthStateChangedListener","PrivateRoute","observer","jsx","_jsx","jsxs","_jsxs","App","profileStore","authStore","walletStore","user","setUser","activeUser","setActiveUser","window","sessionStorage","getItem","unsubscribe","res","getIdToken","then","idToken","setItem","getProfile","error","emailVerified","checkAndRenewToken","userData","currentUser","err","intervalCheck","setInterval","clearInterval","className","children","path","element"],"sources":["/Users/mac/Desktop/Peoples Practice/Aeroconvert-frontend/src/App.tsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\nimport Home from \"./pages/Home\";\nimport Login from \"./pages/Login\";\nimport Register from \"./pages/Register\";\nimport Dashboard from \"./pages/Dashboard\";\nimport Profile from \"./pages/Profile\";\nimport { SetAllAccessTokens, StoreContext } from \"./mobx stores/RootStore\";\nimport {\n  auth,\n  onAuthStateChangedListener,\n  // requestPermission,\n} from \"./firebase/firebase\";\nimport PrivateRoute from \"./component/PrivateRoute\";\n// import ProtectedRoute from \"./component/ProtectedRoute\";\nimport { observer } from \"mobx-react-lite\";\n\nfunction App() {\n  const { profileStore, authStore, walletStore } = useContext(StoreContext);\n  const [user, setUser] = useState<null | any>(null);\n  const [activeUser, setActiveUser] = React.useState(\n    false || window.sessionStorage.getItem(\"userStatus\") === \"true\"\n  );\n\n  useEffect(() => {\n    const unsubscribe = onAuthStateChangedListener(async (res: any) => {\n      if (res) {\n        res?.getIdToken(true).then((idToken: string) => {\n          window.sessionStorage.setItem(\"accessToken\", idToken);\n          SetAllAccessTokens(idToken);\n          try {\n            authStore.setUser(res);\n            profileStore.getProfile();\n            // walletStore.getWallet(); // to call when on dashboard and disable from here\n          } catch (error) {\n          } finally {\n          }\n        });\n        if (res) {\n          if (res.emailVerified) {\n            window.sessionStorage.setItem(\"userStatus\", \"true\");\n            setActiveUser(true);\n          }\n        } else {\n          window.sessionStorage.setItem(\"userStatus\", \"false\");\n          setActiveUser(false);\n        }\n        return res ? setUser(res) : setUser(null);\n      }\n    });\n    return unsubscribe;\n  }, []);\n\n  useEffect(() => {\n    const checkAndRenewToken = async () => {\n      const userData: any = auth.currentUser;\n      if (userData) {\n        try {\n          await userData.getIdToken(true).then((idToken: string) => {\n            window.sessionStorage.setItem(\"accessToken\", idToken);\n            SetAllAccessTokens(idToken);\n          });\n          // console.debug('Token refreshed successfully.');\n        } catch (err) {\n          // console.debug('Error refreshing token:', err);\n        }\n      }\n    };\n    const intervalCheck = setInterval(checkAndRenewToken, 600000);\n\n    return () => clearInterval(intervalCheck);\n  }, []);\n\n  return (\n    <div className=\"\">\n      <Router>\n        <Routes>\n          <Route path=\"/\" element={<Home />} />\n          <Route path=\"/*\" element={<Home />} />\n          <Route path=\"/login\" element={<Login />} />\n            <Route path=\"/register\" element={<Register />} />\n          <Route element={<PrivateRoute activeUser={auth.currentUser} />}>\n            <Route path=\"/dashboard\" element={<Dashboard />} />\n            <Route path=\"/profile\" element={<Profile />} />\n          </Route>\n        </Routes>\n      </Router>\n    </div>\n  );\n}\n\nexport default observer(App);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}